{% extends "base.html" %}

{% block head %}
<title>Answer Feedback - {{ quiz.name }}</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/quiz.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/feedback.css') }}">
{% endblock %}

{% block body %}
<div class="feedback-page-container">

    <div class="feedback-content-wrapper">
        <h1 class="quiz-title-feedback">{{ quiz.name }}</h1>
        
        <div class="quiz-card feedback-result {{ 'feedback-correct' if is_correct else 'feedback-incorrect' }}">
            <div class="feedback-icon">
                {{ '✅' if is_correct else '❌' }}
            </div>
            <div class="feedback-message">
                {{ 'Correct!' if is_correct else 'Incorrect!' }}
            </div>
        </div>
        
        <div class="quiz-card answer-details">
            <div class="question-text">
                {{ question.question_text }}
            </div>
            
            <div class="answers-review">
                {% for option in question.options %}
                    <div class="answer-option 
                        {% if loop.index0 == question.answer_index %}correct-answer{% endif %}
                        {% if loop.index0 == selected_index and not is_correct %}your-wrong-answer{% endif %}">
                        
                        {% if loop.index0 == selected_index %}
                            <strong>Your Answer:</strong> {{ option }}
                        {% elif loop.index0 == question.answer_index %}
                            <strong>Correct Answer:</strong> {{ option }}
                        {% else %}
                            {{ option }}
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
            
            {% if question.explanation and question.explanation.strip() %}
            <div class="explanation-section">
                <h3>Explanation</h3>
                <p class="explanation-text">{{ question.explanation }}</p>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="feedback-footer">
        <form action="{{ url_for('quiz.next_question', quiz_id=quiz.id) }}" method="post">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <button type="submit" class="quiz-btn continue-btn">
                {% if is_last_question %}
                    Finish & View Results →
                {% else %}
                    Continue to Next Question →
                {% endif %}
            </button>
        </form>
    </div>

</div>
{% endblock %}
