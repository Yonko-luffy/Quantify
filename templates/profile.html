{% extends "base.html" %}

{% block head %}
    <title>User Profile</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
{% endblock %}

{% block body %}
<!-- Error message from direct rendering -->
{% if error %}
  <div class="alert alert-danger">
    {{ error }}
  </div>
{% endif %}

<div class="profile-card animate-fadeIn">
  <div class="profile-avatar">
    {{ profile_owner.username[0]|upper if profile_owner else 'U' }}
  </div>
  <div class="profile-username">{{ profile_owner.username if profile_owner else 'Username' }}</div>
  {% if current_user.is_authenticated and current_user.username == profile_owner.username %}
    <div class="profile-email">{{ profile_owner.email if profile_owner else 'user@email.com' }}</div>
  {% endif %}
  <div class="profile-about">
    {% if profile_owner %}
      {% if current_user.is_authenticated and current_user.username == profile_owner.username %}
        Welcome to your profile! Update your info to personalize your experience.
      {% else %}
        {{ profile_owner.username }}'s Profile
      {% endif %}
    {% else %}
      Welcome to QuizApp!
    {% endif %}
  </div>
  <div class="profile-divider"></div>
  <a href="{{ url_for('quiz.index') }}" class="profile-back">‚Üê Back to Home page</a>
  <div class="profile-actions">
    {% if current_user.is_authenticated %}
      {% if current_user.username == profile_owner.username %}
        <form action="{{ url_for('auth.logout') }}" method="post">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <button type="submit" class="quiz-btn">Log out</button>
        </form>
        <a href="{{ url_for('auth.profile_user', username=current_user.username) }}" class="quiz-btn refresh-btn">Refresh</a>
      {% else %}
        <a href="{{ url_for('auth.profile_user', username=current_user.username) }}" class="quiz-btn">My Profile</a>
      {% endif %}
    {% else %}
      <a href="{{ url_for('auth.login') }}" class="quiz-btn">Login to see your profile</a>
    {% endif %}
  </div>
</div>
{% endblock %}